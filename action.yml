name: "Validate Input and Call API"
description: "Validates input JSON and calls an API if valid"
inputs:
  input-data:
    description: "The input data in JSON format"
    required: true
runs:
  using: "composite"
  steps:
    - name: Checkout Repository
      uses: actions/checkout@v4

    - name: Set Up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.x'

    - name: Write Input to File
      run: echo '${{ inputs.input-data }}' > input.json
      shell: bash

    - name: List files for debugging
      run: |
        echo "Listing all files and folders in the repository:"
        ls -alR  # List all files and folders recursively in the current directory
      shell: bash

    - name: Validate Input
      run: python validate.py
      shell: bash

    - name: Print Input JSON
      run: cat input.json  # Print input.json before calling the API
      shell: bash

    - name: Call API (Only if Validation Passes)
      run: |
        echo "âœ… Calling API..."
        curl -X POST https://example.com/api --data @input.json
      shell: bash
